╔═══════════════════════════════════════════════════════════════╗
║         CHARMSTRACKER DEPLOYMENT - FINAL STEPS                ║
╚═══════════════════════════════════════════════════════════════╝

STATUS:
✅ Frontend built successfully
✅ Nginx configurations ready
⏳ Need to complete backend setup on server

═══════════════════════════════════════════════════════════════

ON YOUR HOSTINGER SERVER - SSH AND RUN THESE:

═══════════════════════════════════════════════════════════════

📋 COPY THIS ENTIRE BLOCK AND PASTE IN YOUR SSH TERMINAL:

───────────────────────────────────────────────────────────────
cd /root/Charmstracker/backend && \
python3 -m venv venv && \
source venv/bin/activate && \
pip install -r requirements.txt && \
deactivate && \
cat > /root/Charmstracker/backend/.env << 'EOF'
MONGO_URL="mongodb+srv://carefreelixe_db_user:d9po0rKPJwchyCBE@laundry.bhx3jw0.mongodb.net/?retryWrites=true&w=majority"
DB_NAME="charmtracker_production"
CORS_ORIGINS="http://charmstracker.com,http://www.charmstracker.com,https://charmstracker.com,https://www.charmstracker.com,http://31.220.50.205"
EOF

cp /root/Charmstracker/charmstracker-api.service /etc/systemd/system/ && \
systemctl daemon-reload && \
systemctl enable charmstracker-api && \
systemctl start charmstracker-api && \
systemctl reload nginx && \
echo "" && \
echo "═══════════════════════════════════════════════════════════" && \
echo "✅ SETUP COMPLETE!" && \
echo "═══════════════════════════════════════════════════════════" && \
systemctl status charmstracker-api --no-pager && \
echo "" && \
echo "Testing API..." && \
sleep 2 && \
curl http://127.0.0.1:8000/api/ && \
echo "" && \
echo "" && \
echo "🌐 ACCESS YOUR APP:" && \
echo "   Frontend: http://charmstracker.com" && \
echo "   API: http://31.220.50.205/api/" && \
echo ""
───────────────────────────────────────────────────────────────

═══════════════════════════════════════════════════════════════

IF YOU GET MONGODB ERROR:

───────────────────────────────────────────────────────────────
systemctl status mongod
# If not running, install:
curl -fsSL https://www.mongodb.org/static/pgp/server-7.0.asc | gpg -o /usr/share/keyrings/mongodb-server-7.0.gpg --dearmor && \
echo "deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-7.0.gpg ] https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/7.0 multiverse" | tee /etc/apt/sources.list.d/mongodb-org-7.0.list && \
apt update && \
apt install -y mongodb-org && \
systemctl start mongod && \
systemctl enable mongod
───────────────────────────────────────────────────────────────

═══════════════════════════════════════════════════════════════

SEED DATABASE (OPTIONAL):

───────────────────────────────────────────────────────────────
cd /root/Charmstracker/backend && \
source venv/bin/activate && \
python seed_data.py && \
deactivate
───────────────────────────────────────────────────────────────

═══════════════════════════════════════════════════════════════

VIEW LOGS:

───────────────────────────────────────────────────────────────
# Backend logs (live)
journalctl -u charmstracker-api -f

# Backend logs (last 50 lines)
journalctl -u charmstracker-api -n 50 --no-pager

# Nginx logs
tail -f /var/log/nginx/charmstracker_api_access.log
tail -f /var/log/nginx/charmstracker_frontend_access.log
───────────────────────────────────────────────────────────────

═══════════════════════════════════════════════════════════════

CHECK STATUS:

───────────────────────────────────────────────────────────────
systemctl status charmstracker-api
systemctl status nginx
systemctl status mongod
───────────────────────────────────────────────────────────────

═══════════════════════════════════════════════════════════════

RESTART SERVICES:

───────────────────────────────────────────────────────────────
systemctl restart charmstracker-api
systemctl reload nginx
───────────────────────────────────────────────────────────────

═══════════════════════════════════════════════════════════════

SETUP DNS (IMPORTANT!):

1. Go to your domain registrar (where you bought charmstracker.com)
2. Add these A records:
   
   Type: A
   Name: @
   Value: 31.220.50.205
   TTL: 3600

   Type: A
   Name: www
   Value: 31.220.50.205
   TTL: 3600

3. Wait 1-2 hours for DNS to propagate
4. Check: https://dnschecker.org/

═══════════════════════════════════════════════════════════════

SETUP SSL (After DNS works):

───────────────────────────────────────────────────────────────
apt install -y certbot python3-certbot-nginx && \
certbot --nginx -d charmstracker.com -d www.charmstracker.com
───────────────────────────────────────────────────────────────

═══════════════════════════════════════════════════════════════

FINAL ACCESS URLS:

🌐 Frontend: http://charmstracker.com (https:// after SSL)
🔌 API: http://31.220.50.205/api/

═══════════════════════════════════════════════════════════════

TROUBLESHOOTING:

If backend fails:
→ journalctl -u charmstracker-api -n 100 --no-pager

If API not responding:
→ curl http://127.0.0.1:8000/api/
→ netstat -tlnp | grep 8000

If Nginx errors:
→ nginx -t
→ tail -f /var/log/nginx/error.log

═══════════════════════════════════════════════════════════════
